# トランザクション設計

> このドキュメントはPhase 10で記述します。

## 概要

シミュレーション実行時のトランザクション設計について説明します。

## ACID特性の保証

### Atomicity（原子性）
- シミュレーション実行は全て成功するか、全て失敗する

### Consistency（一貫性）
- 外部キー制約によりデータの整合性を維持

### Isolation（分離性）
- 同時実行されるシミュレーションは互いに影響しない

### Durability（永続性）
- コミット後のデータは永続化される

## トランザクションの範囲

```typescript
await prisma.$transaction(async (tx) => {
  // 1. Simulationレコード作成
  // 2. ベクトル検索実行
  // 3. PredictedReview一括挿入
  // 4. 集計結果の保存
});
```

## エラーハンドリング

TODO: ロールバック処理の詳細を記述
