(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{9913:function(e,s,t){Promise.resolve().then(t.bind(t,4986))},4986:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var a=t(7437),l=t(2265),i=t(9376),r=t(7648),n=t(1436),c=t(7533),d=t(6940),x=t(7059),m=t(2994),o=t(8155),h=t(5786),u=t(407),j=t(3250);let g=["#ef4444","#f97316","#eab308","#84cc16","#22c55e"],b={"Brand Loyal":"ブランド重視","Design Lovers":"デザイン重視","Price Sensitive":"価格重視","Quality Focused":"品質重視"};function v(){var e,s;let t=(0,i.useParams)().simulationId,[v,y]=(0,l.useState)(null),[N,f]=(0,l.useState)(!0),[p,w]=(0,l.useState)(null);if((0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/results/".concat(t)),s=await e.json();if(!e.ok)throw Error(s.error||"結果の取得に失敗しました");y(s)}catch(e){w(e instanceof Error?e.message:"エラーが発生しました")}finally{f(!1)}})()},[t]),N)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"結果を読み込み中..."})]})});if(p||!v)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:p||"結果が見つかりません"}),(0,a.jsx)(r.default,{href:"/input",className:"text-blue-600 hover:underline",children:"入力画面に戻る"})]})});let k=[{name:"1",value:v.distribution.star1,label:"1"},{name:"2",value:v.distribution.star2,label:"2"},{name:"3",value:v.distribution.star3,label:"3"},{name:"4",value:v.distribution.star4,label:"4"},{name:"5",value:v.distribution.star5,label:"5"}];return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 py-12",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 max-w-4xl",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"シミュレーション結果"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[v.totalReviews.toLocaleString(),"人の顧客による予測評価"]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"平均評価"}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"text-6xl font-bold text-gray-800",children:(null===(e=v.simulation.avgRating)||void 0===e?void 0:e.toFixed(1))||"-"}),(0,a.jsx)("span",{className:"text-3xl text-yellow-500",children:"★"})]}),(0,a.jsx)("div",{className:"flex justify-center mt-2",children:[1,2,3,4,5].map(e=>(0,a.jsx)("span",{className:"text-2xl ".concat(e<=Math.round(v.simulation.avgRating||0)?"text-yellow-500":"text-gray-300"),children:"★"},e))})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"高評価率（★4以上）"}),(0,a.jsxs)("div",{className:"text-6xl font-bold text-green-600",children:[(null===(s=v.simulation.conversionRate)||void 0===s?void 0:s.toFixed(1))||"-",(0,a.jsx)("span",{className:"text-3xl",children:"%"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[Math.round(v.totalReviews*(v.simulation.conversionRate||0)/100).toLocaleString(),"人が高評価"]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"評価分布"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(c.v,{data:k,layout:"vertical",children:[(0,a.jsx)(d.q,{strokeDasharray:"3 3"}),(0,a.jsx)(x.K,{type:"number",domain:[0,100],unit:"%"}),(0,a.jsx)(m.B,{type:"category",dataKey:"label",width:30,tickFormatter:e=>"★".concat(e)}),(0,a.jsx)(o.u,{formatter:e=>["".concat(e.toFixed(1),"%"),"割合"]}),(0,a.jsx)(h.$Q,{dataKey:"value",radius:[0,4,4,0],children:k.map((e,s)=>(0,a.jsx)(u.b,{fill:g[s]},"cell-".concat(s)))})]})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"セグメント別分析"}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 gap-4 mb-8",children:v.segments.map(e=>{var s;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800",children:null!==(s=b[e.name])&&void 0!==s?s:e.name}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.customerCount.toLocaleString(),"人"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-800",children:e.avgRating.toFixed(1)}),(0,a.jsx)("span",{className:"text-yellow-500",children:"★"}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2 ml-2",children:(0,a.jsx)("div",{className:"bg-blue-500 rounded-full h-2",style:{width:"".concat(e.avgRating/5*100,"%")}})})]})]},e.name)})}),(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"セグメント別評価分布"}),(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(c.v,{data:v.segments.map(e=>{var s;return{segment:null!==(s=b[e.name])&&void 0!==s?s:e.name,"★1":e.distribution.star1,"★2":e.distribution.star2,"★3":e.distribution.star3,"★4":e.distribution.star4,"★5":e.distribution.star5}}),margin:{top:20,right:30,left:20,bottom:5},children:[(0,a.jsx)(d.q,{strokeDasharray:"3 3"}),(0,a.jsx)(x.K,{dataKey:"segment"}),(0,a.jsx)(m.B,{unit:"%"}),(0,a.jsx)(o.u,{formatter:e=>["".concat(e.toFixed(1),"%"),"割合"]}),(0,a.jsx)(j.D,{}),(0,a.jsx)(h.$Q,{dataKey:"★1",stackId:"a",fill:"#ef4444"}),(0,a.jsx)(h.$Q,{dataKey:"★2",stackId:"a",fill:"#f97316"}),(0,a.jsx)(h.$Q,{dataKey:"★3",stackId:"a",fill:"#eab308"}),(0,a.jsx)(h.$Q,{dataKey:"★4",stackId:"a",fill:"#84cc16"}),(0,a.jsx)(h.$Q,{dataKey:"★5",stackId:"a",fill:"#22c55e"})]})})})]})]}),v.similarityDistribution&&v.similarityDistribution.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"類似度分布"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"商品説明と顧客プロファイルの類似度の分布を表示します。"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.h,{width:"100%",height:"100%",children:(0,a.jsxs)(c.v,{data:v.similarityDistribution.map(e=>({...e,label:"".concat((100*e.bucket).toFixed(0),"%")})),children:[(0,a.jsx)(d.q,{strokeDasharray:"3 3"}),(0,a.jsx)(x.K,{dataKey:"label"}),(0,a.jsx)(m.B,{}),(0,a.jsx)(o.u,{formatter:e=>["".concat(e.toLocaleString(),"人"),"顧客数"]}),(0,a.jsx)(h.$Q,{dataKey:"count",fill:"#3b82f6",radius:[4,4,0,0]})]})})})]}),v.sampleReviews&&v.sampleReviews.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"サンプルレビュー"}),(0,a.jsx)("div",{className:"space-y-4",children:v.sampleReviews.map((e,s)=>{var t;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(s=>(0,a.jsx)("span",{className:"text-lg ".concat(s<=e.rating?"text-yellow-500":"text-gray-300"),children:"★"},s))}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:null!==(t=b[e.segmentName])&&void 0!==t?t:e.segmentName})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["類似度: ",(100*e.similarity).toFixed(1),"%"]})]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.reviewText})]},s)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"商品情報"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"カテゴリ: "}),(0,a.jsx)("span",{className:"text-gray-800",children:v.product.category})]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"説明: "}),(0,a.jsx)("span",{className:"text-gray-800",children:v.product.description})]})]})]}),(0,a.jsx)("div",{className:"flex justify-center gap-4",children:(0,a.jsx)(r.default,{href:"/input",className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"新しいシミュレーション"})})]})})}}},function(e){e.O(0,[587,971,117,744],function(){return e(e.s=9913)}),_N_E=e.O()}]);