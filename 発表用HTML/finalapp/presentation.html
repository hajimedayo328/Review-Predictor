<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Predictor - プレゼンテーション</title>

    <!-- Reveal.js CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/theme/white.css">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Noto+Sans+JP:wght@300;400;500;600;700;800&display=swap');

        :root {
            --primary-blue: #3b82f6;
            --primary-blue-dark: #2563eb;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --bg-white: #ffffff;
            --bg-gray: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
        }

        .reveal {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
        }

        .reveal .slides section {
            text-align: left;
            padding: 3rem 4rem;
        }

        .reveal h1 {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-blue), #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .reveal h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            border-bottom: 3px solid var(--primary-blue);
            padding-bottom: 0.5rem;
        }

        .reveal h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-blue);
        }

        .reveal p, .reveal li {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .reveal ul {
            list-style: none;
            padding-left: 0;
        }

        .reveal ul li::before {
            content: "→";
            color: var(--primary-blue);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }

        .highlight-box {
            background: linear-gradient(135deg, #eff6ff, #f0fdf4);
            border-left: 4px solid var(--primary-blue);
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .stat-box {
            background: var(--primary-blue);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-box .number {
            font-size: 2.5rem;
            font-weight: 800;
        }

        .stat-box .label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .team-badge {
            background: linear-gradient(135deg, var(--primary-blue), #8b5cf6);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            display: inline-block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: #f8fafc;
            font-weight: 600;
            color: var(--text-primary);
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .code-block .keyword { color: #c084fc; }
        .code-block .string { color: #86efac; }
        .code-block .comment { color: #64748b; }

        .flow-arrow {
            font-size: 2rem;
            color: var(--primary-blue);
        }

        .persona-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .persona-card h4 {
            color: var(--primary-blue);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- スライド1: タイトル -->
            <section>
                <div class="text-center">
                    <div class="team-badge mb-8">チーム おでん</div>
                    <h1 class="text-center">Review Predictor</h1>
                    <p class="text-2xl text-gray-600 mt-4">
                        新商品の説明文から、10,000人の仮想顧客が<br>
                        どう評価するかを予測するシミュレーションツール
                    </p>
                    <div class="mt-12 text-gray-500">
                        データベース 最終課題
                    </div>
                </div>
            </section>

            <!-- スライド2: メンバー紹介 -->
            <section>
                <h2>メンバー</h2>
                <div class="grid grid-cols-2 gap-6 mt-8">
                    <div class="card">
                        <p class="text-gray-500 text-sm">2442001</p>
                        <p class="text-xl font-bold text-gray-800">赤塩 甫</p>
                    </div>
                    <div class="card">
                        <p class="text-gray-500 text-sm">2442003</p>
                        <p class="text-xl font-bold text-gray-800">阿部 純太</p>
                    </div>
                    <div class="card">
                        <p class="text-gray-500 text-sm">2442040</p>
                        <p class="text-xl font-bold text-gray-800">シャリフ 大睦</p>
                    </div>
                    <div class="card">
                        <p class="text-gray-500 text-sm">2442071</p>
                        <p class="text-xl font-bold text-gray-800">服田 愛樹</p>
                    </div>
                </div>
            </section>

            <!-- スライド3: 解決したい課題 -->
            <section>
                <h2>解決したい課題</h2>
                <div class="highlight-box text-xl">
                    ECサイトで新商品を出品する際、<br>
                    <strong class="text-2xl">「この商品は売れるのか？」</strong> という不安
                </div>
                <ul class="mt-8 space-y-4">
                    <li>レビューがない新商品は購入されにくい</li>
                    <li>実際に売り出すまで顧客の反応がわからない</li>
                    <li>商品説明文の書き方で売上が大きく変わる</li>
                </ul>
            </section>

            <!-- スライド4: 本システムのアプローチ -->
            <section>
                <h2>本システムのアプローチ</h2>
                <div class="highlight-box text-xl mb-8">
                    <strong>「売る前に、顧客の反応を予測できたら？」</strong>
                </div>
                <div class="flex items-center justify-center gap-4 text-lg">
                    <div class="card text-center px-6">商品説明文</div>
                    <span class="flow-arrow">→</span>
                    <div class="card text-center px-6">ベクトル化</div>
                    <span class="flow-arrow">→</span>
                    <div class="card text-center px-6">10,000人と<br>類似度計算</div>
                    <span class="flow-arrow">→</span>
                    <div class="card text-center px-6">評価予測</div>
                    <span class="flow-arrow">→</span>
                    <div class="card text-center px-6">統計表示</div>
                </div>
            </section>

            <!-- スライド5: ペルソナ -->
            <section>
                <h2>ターゲットユーザー（ペルソナ）</h2>
                <div class="grid grid-cols-3 gap-4 mt-6">
                    <div class="persona-card">
                        <h4>田中 美咲（32歳）</h4>
                        <p class="text-sm text-gray-600">ハンドメイド作家</p>
                        <p class="text-sm mt-2"><strong>悩み:</strong> 新作のレビューがつくまで売れない</p>
                    </div>
                    <div class="persona-card">
                        <h4>鈴木 健太（28歳）</h4>
                        <p class="text-sm text-gray-600">D2Cマーケター</p>
                        <p class="text-sm mt-2"><strong>悩み:</strong> A/Bテストに時間がかかる</p>
                    </div>
                    <div class="persona-card">
                        <h4>山田 太郎（45歳）</h4>
                        <p class="text-sm text-gray-600">商品企画部長</p>
                        <p class="text-sm mt-2"><strong>悩み:</strong> 売れる根拠を示せない</p>
                    </div>
                </div>
            </section>

            <!-- スライド6: システムアーキテクチャ -->
            <section>
                <h2>システムアーキテクチャ</h2>
                <div class="grid grid-cols-3 gap-6 mt-6">
                    <div class="card">
                        <h3 class="text-lg mb-2">フロントエンド</h3>
                        <ul class="text-sm space-y-1">
                            <li>Next.js 14</li>
                            <li>React + TypeScript</li>
                            <li>Tailwind CSS</li>
                            <li>Recharts</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3 class="text-lg mb-2">バックエンド</h3>
                        <ul class="text-sm space-y-1">
                            <li>Next.js API Routes</li>
                            <li>Prisma ORM</li>
                            <li>transformers.js</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3 class="text-lg mb-2">データベース</h3>
                        <ul class="text-sm space-y-1">
                            <li>PostgreSQL 15</li>
                            <li>pgvector拡張</li>
                            <li>HNSWインデックス</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- スライド7: なぜPostgreSQL + pgvectorか -->
            <section>
                <h2>技術選定の理由</h2>
                <h3 class="mb-4">なぜ PostgreSQL + pgvector か？</h3>
                <table>
                    <tr>
                        <th>選択肢</th>
                        <th>検討結果</th>
                    </tr>
                    <tr>
                        <td><strong class="text-green-600">PostgreSQL + pgvector ✓</strong></td>
                        <td>RDB機能とベクトル検索を1つのDBで実現</td>
                    </tr>
                    <tr>
                        <td>MySQL</td>
                        <td>ベクトル検索の拡張がない</td>
                    </tr>
                    <tr>
                        <td>MongoDB</td>
                        <td>JOINが苦手、正規化の利点が活かせない</td>
                    </tr>
                    <tr>
                        <td>専用VectorDB</td>
                        <td>RDBと別管理、データ同期が複雑</td>
                    </tr>
                </table>
            </section>

            <!-- スライド8: データベース設計 -->
            <section>
                <h2>データベース設計（ER図）</h2>
                <div class="grid grid-cols-2 gap-8 mt-4">
                    <div>
                        <h3 class="mb-4">7テーブル構成</h3>
                        <table class="text-sm">
                            <tr><th>テーブル</th><th>レコード数</th></tr>
                            <tr><td>sellers</td><td>1</td></tr>
                            <tr><td>categories</td><td>5</td></tr>
                            <tr><td>products</td><td>シミュレーション数</td></tr>
                            <tr><td>segments</td><td>4</td></tr>
                            <tr><td>customers</td><td class="font-bold text-blue-600">10,000</td></tr>
                            <tr><td>simulations</td><td>実行数</td></tr>
                            <tr><td>predicted_reviews</td><td>実行数 × 10,000</td></tr>
                        </table>
                    </div>
                    <div>
                        <h3 class="mb-4">リレーション</h3>
                        <div class="code-block text-xs">
Seller ||--o{ Product<br>
Category ||--o{ Product<br>
Segment ||--o{ Customer<br>
Product ||--o{ Simulation<br>
Simulation ||--o{ PredictedReview<br>
Customer ||--o{ PredictedReview
                        </div>
                    </div>
                </div>
            </section>

            <!-- スライド9: 正規化 -->
            <section>
                <h2>正規化（第3正規形）</h2>
                <div class="highlight-box mb-6">
                    全7テーブルが<strong>第3正規形（3NF）</strong>を満たしている
                </div>
                <div class="grid grid-cols-2 gap-8">
                    <div>
                        <h3 class="mb-2">正規化の確認</h3>
                        <table class="text-sm">
                            <tr><th>テーブル</th><th>1NF</th><th>2NF</th><th>3NF</th></tr>
                            <tr><td>sellers</td><td>✓</td><td>✓</td><td>✓</td></tr>
                            <tr><td>categories</td><td>✓</td><td>✓</td><td>✓</td></tr>
                            <tr><td>products</td><td>✓</td><td>✓</td><td>✓</td></tr>
                            <tr><td>customers</td><td>✓</td><td>✓</td><td>✓</td></tr>
                            <tr><td>simulations</td><td>✓</td><td>✓</td><td>✓</td></tr>
                            <tr><td>predicted_reviews</td><td>✓</td><td>✓</td><td>✓</td></tr>
                        </table>
                    </div>
                    <div>
                        <h3 class="mb-2">ポイント</h3>
                        <ul class="text-sm space-y-2">
                            <li>ベクトル型はpgvectorで原子的に扱う</li>
                            <li>外部キーで推移的従属を排除</li>
                            <li>avgRating等は計算キャッシュ</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- スライド10: 外部キー制約 -->
            <section>
                <h2>外部キー制約</h2>
                <div class="code-block mb-6">
<span class="comment">-- prisma/schema.prisma より</span><br><br>
<span class="keyword">model</span> PredictedReview {<br>
&nbsp;&nbsp;simulation Simulation <span class="keyword">@relation</span>(<span class="string">onDelete: Cascade</span>)<br>
&nbsp;&nbsp;<span class="comment">// → シミュレーション削除時に予測レビューも自動削除</span><br>
}
                </div>
                <div class="grid grid-cols-2 gap-6">
                    <div class="card">
                        <h3 class="text-lg mb-2">CASCADE DELETE</h3>
                        <p class="text-sm text-gray-600">
                            シミュレーションを削除すると、<br>
                            紐づく10,000件のレビューも自動削除
                        </p>
                    </div>
                    <div class="card">
                        <h3 class="text-lg mb-2">参照整合性</h3>
                        <p class="text-sm text-gray-600">
                            存在しない商品・顧客への<br>
                            レビュー作成を防止
                        </p>
                    </div>
                </div>
            </section>

            <!-- スライド11: トランザクション -->
            <section>
                <h2>トランザクション（原子性）</h2>
                <div class="code-block text-sm mb-6">
<span class="comment">// 商品とシミュレーションを1つのトランザクションで作成</span><br>
<span class="keyword">const</span> result = <span class="keyword">await</span> prisma.<span class="keyword">$transaction</span>(<span class="keyword">async</span> (tx) => {<br>
&nbsp;&nbsp;<span class="comment">// 1. 商品を作成</span><br>
&nbsp;&nbsp;<span class="keyword">await</span> tx.$executeRawUnsafe(<span class="string">`INSERT INTO products ...`</span>);<br><br>
&nbsp;&nbsp;<span class="comment">// 2. シミュレーションを作成</span><br>
&nbsp;&nbsp;<span class="keyword">const</span> simulation = <span class="keyword">await</span> tx.simulation.create({...});<br><br>
&nbsp;&nbsp;<span class="keyword">return</span> { productId, simulationId };<br>
});<br>
<span class="comment">// → どちらかが失敗したら両方ロールバック</span>
                </div>
            </section>

            <!-- スライド12: ベクトル検索 -->
            <section>
                <h2>ベクトル類似度検索（pgvector）</h2>
                <div class="code-block text-sm mb-6">
<span class="comment">-- コサイン距離演算子 <=> を使用</span><br>
<span class="keyword">SELECT</span><br>
&nbsp;&nbsp;c.id,<br>
&nbsp;&nbsp;(1 - (c."preferenceVector" <span class="string"><=></span> $1::vector(384))) <span class="keyword">as</span> similarity<br>
<span class="keyword">FROM</span> customers c<br>
<span class="keyword">ORDER BY</span> c."preferenceVector" <span class="string"><=></span> $1::vector(384)<br>
<span class="keyword">LIMIT</span> 10000;
                </div>
                <div class="grid grid-cols-2 gap-6">
                    <div class="stat-box">
                        <div class="number">O(log n)</div>
                        <div class="label">HNSWインデックスの計算量</div>
                    </div>
                    <div class="stat-box" style="background: #10b981;">
                        <div class="number">~10ms</div>
                        <div class="label">10,000件の検索時間</div>
                    </div>
                </div>
            </section>

            <!-- スライド13: パフォーマンス最適化 -->
            <section>
                <h2>パフォーマンス最適化</h2>
                <h3 class="mb-4">バッチINSERT</h3>
                <div class="grid grid-cols-2 gap-6">
                    <div class="card" style="border-left: 4px solid #ef4444;">
                        <h4 class="text-red-500 font-bold mb-2">❌ 悪い例</h4>
                        <p class="text-sm">1件ずつINSERT<br>→ 10,000回のINSERT</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #10b981;">
                        <h4 class="text-green-500 font-bold mb-2">✓ 採用した方法</h4>
                        <p class="text-sm">1,000件ずつバッチ<br>→ 10回のINSERT</p>
                    </div>
                </div>
                <table class="mt-6 text-sm">
                    <tr><th>処理</th><th>目標</th><th>実測</th></tr>
                    <tr><td>ベクトル検索</td><td>< 100ms</td><td class="text-green-600">~13ms</td></tr>
                    <tr><td>バッチINSERT</td><td>< 5000ms</td><td class="text-green-600">~3000ms</td></tr>
                    <tr><td>合計</td><td>< 10秒</td><td class="text-green-600 font-bold">~5秒</td></tr>
                </table>
            </section>

            <!-- スライド14: 授業要件対応 -->
            <section>
                <h2>授業要件への対応</h2>
                <table class="text-sm">
                    <tr><th>授業回</th><th>テーマ</th><th>本システムでの実装</th></tr>
                    <tr><td>#2</td><td>Disk and File</td><td>pgvectorのHNSWインデックス</td></tr>
                    <tr><td>#3</td><td>RDB Table</td><td>7テーブルの正規化設計</td></tr>
                    <tr><td>#4</td><td>SQL, Transaction</td><td>シミュレーション実行のACID保証</td></tr>
                    <tr><td>#5</td><td>FK, JOIN, SubQuery</td><td>セグメント別集計の複合クエリ</td></tr>
                    <tr><td>#8</td><td>正規化, DB Tuning</td><td>第3正規形 + EXPLAIN ANALYZE</td></tr>
                    <tr><td>#10</td><td>分散DB</td><td>Read Replicaアーキテクチャ設計</td></tr>
                    <tr><td>#11</td><td>Vector DB</td><td><strong>pgvectorによるベクトル類似度検索</strong></td></tr>
                </table>
            </section>

            <!-- スライド15: デモ -->
            <section>
                <h2>デモンストレーション</h2>
                <div class="text-center mt-12">
                    <div class="stat-box inline-block px-12 py-8">
                        <div class="number">DEMO</div>
                        <div class="label">実際にシミュレーションを実行します</div>
                    </div>
                </div>
                <div class="mt-12 text-center">
                    <p class="text-gray-600">
                        1. 商品説明文を入力<br>
                        2. シミュレーション実行<br>
                        3. 結果画面で評価分布・セグメント分析を確認
                    </p>
                </div>
            </section>

            <!-- スライド16: AI活用 -->
            <section>
                <h2>AI（Claude Code）の活用</h2>
                <div class="grid grid-cols-2 gap-6 mt-6">
                    <div>
                        <h3 class="mb-4">AIが担当</h3>
                        <ul class="space-y-2 text-sm">
                            <li>スキーマ設計のレビュー</li>
                            <li>コード実装の補助</li>
                            <li>ドキュメント作成</li>
                            <li>デバッグ支援</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="mb-4">人間が判断</h3>
                        <ul class="space-y-2 text-sm">
                            <li>ペルソナ設計</li>
                            <li>評価予測アルゴリズム</li>
                            <li>UI/UXデザイン</li>
                            <li>技術選定</li>
                        </ul>
                    </div>
                </div>
                <div class="highlight-box mt-8">
                    <strong>学び:</strong> AIは効率化ツール。設計の意思決定は人間が行う。
                </div>
            </section>

            <!-- スライド17: 開発プロセス -->
            <section>
                <h2>開発プロセス</h2>
                <div class="grid grid-cols-5 gap-4 mt-8">
                    <div class="card text-center">
                        <div class="text-2xl font-bold text-blue-600">1日</div>
                        <div class="text-sm text-gray-600 mt-2">企画・設計</div>
                    </div>
                    <div class="card text-center">
                        <div class="text-2xl font-bold text-blue-600">1日</div>
                        <div class="text-sm text-gray-600 mt-2">DB設計</div>
                    </div>
                    <div class="card text-center">
                        <div class="text-2xl font-bold text-blue-600">2日</div>
                        <div class="text-sm text-gray-600 mt-2">バックエンド</div>
                    </div>
                    <div class="card text-center">
                        <div class="text-2xl font-bold text-blue-600">1日</div>
                        <div class="text-sm text-gray-600 mt-2">フロント</div>
                    </div>
                    <div class="card text-center">
                        <div class="text-2xl font-bold text-blue-600">1日</div>
                        <div class="text-sm text-gray-600 mt-2">テスト</div>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <div class="stat-box inline-block px-8">
                        <div class="number">約1週間</div>
                        <div class="label">総開発期間</div>
                    </div>
                </div>
            </section>

            <!-- スライド18: まとめ -->
            <section>
                <h2>まとめ</h2>
                <div class="grid grid-cols-2 gap-6 mt-6">
                    <div class="card">
                        <h3 class="text-lg mb-4">実装したこと</h3>
                        <ul class="text-sm space-y-2">
                            <li>10,000人の仮想顧客シミュレーション</li>
                            <li>pgvectorによるベクトル類似度検索</li>
                            <li>第3正規形のDB設計</li>
                            <li>トランザクションによるACID保証</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3 class="text-lg mb-4">学んだこと</h3>
                        <ul class="text-sm space-y-2">
                            <li>RDBとベクトルDBの融合</li>
                            <li>正規化の実践的な適用</li>
                            <li>パフォーマンス最適化</li>
                            <li>AIとの協働開発</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- スライド19: ありがとうございました -->
            <section>
                <div class="text-center">
                    <h1 class="text-center">ご清聴ありがとうございました</h1>
                    <div class="mt-12">
                        <div class="team-badge">チーム おでん</div>
                    </div>
                    <p class="text-gray-500 mt-8">
                        質問をお待ちしております
                    </p>
                </div>
            </section>

        </div>
    </div>

    <!-- Reveal.js -->
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'slide',
            width: 1280,
            height: 720,
            margin: 0.1,
        });
    </script>
</body>
</html>
